<div class="container">
    <div class="row">
    	<div class="col-lg-12">
	     	<h2 class="page-header underline">EBWiki below maps <%= @cases.count %> cases of violence against people of color. Read more <%= link_to 'about us',about_path %></h2>
	        <% if user_signed_in? %>
		     	Click the follow button below the image on any case on the map. We will keep you updated as these cases proceed.</p>
			<% else %>
		    	<%= link_to 'Login', new_user_registration_path %> and follow specific cases and we will update you as they proceed.
			<% end %>
			<div class="text-center">
				<h3>
					<%= link_to 'Back to the Main Page', root_path, class: "btn btn-warning" %>
					<%= link_to 'Get our newsletter', "http://eepurl.com/bt5QCz", class: "btn btn-default" %>
				</h3>
			</div>
			<h2 class="page-subheader">Click on the map pins below to learn more.</h2>
			<div id="markers-on-the-map">
	    		<div id="map page-header">
		    		<div style="width: 640px; height: 480px; margin: auto" id="mapContainer"></div>
					<!-- HERE Maps -->
					<script>
						let platform = new H.service.Platform({
							'apikey': '<%= ENV['HERE_MAPS_API_KEY'] %>'
						});
									      
						// Obtain the default map types from the platform object:
						let defaultLayers = platform.createDefaultLayers();
					      
						// Instantiate (and display) a map object:
					    let map = new H.Map(
					    	document.getElementById('mapContainer'),
							defaultLayers.vector.normal.map,
				        	{
				            	zoom: 4,
				            	center: { lat: 39.83333, lng: -98.58333 }
				       		}
					    );
					    let group = new H.map.Group();
					    let svgMarkup = '<svg width="24" height="24" ' +
						    'xmlns="http://www.w3.org/2000/svg">' +
						    '<rect stroke="white" fill="#1b468d" x="1" y="1" width="22" ' +
						    'height="22" /><text x="12" y="18" font-size="12pt" ' +
						    'font-family="Arial" font-weight="bold" text-anchor="middle" ' +
						    'fill="white">*</text></svg>';
						let icon = new H.map.Icon(svgMarkup);
						let coordinates = <%= @cases %>;
					
						let createdObjects = coordinates.map(coord => new H.map.Marker({lat: coord[0], lng: coord[1]}, {icon: icon}));
						group.addObjects(createdObjects);
						map.addObject(group);
							// get geo bounding box for the group and set it to the map
						map.getViewModel().setLookAtData({
						    bounds: group.getBoundingBox()
						});
						let behavior = new H.mapevents.Behavior(new H.mapevents.MapEvents(map));
					</script>
	    		</div>
		   	</div>
		</div>
	</div>
</div>
